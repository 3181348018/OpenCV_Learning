# OTSU algorithm

**OTSU算法被认为是图像分割中阈值选取的最佳算法，计算简单，不受图像亮度和对比度的影响，因此在数字图像处理上得到了广泛的应用。它是按图像的灰度特性，将图像分成背景和前景两部分。因方差是灰度分布均匀性的一种度量,背景和前景之间的类间方差越大,说明构成图像的两部分的差别越大,当部分前景错分为背景或部分背景错分为前景都会导致两部分差别变小。因此,使类间方差最大的分割意味着错分概率最小。**

## 算法原理

**求类间方差：**

假设是存在阈值TH将图像所有像素分为两类C1(小于TH)和C2(大于TH)，则这两类像素各自的均值就为m1、m2，图像全局均值为mG。同时像素被分为C1和C2类的概率分别为p1、p2。因此就有：

$$
    p1*m1 + p2*m2 = mG \\
    p1+p2 = 1
$$
根据方差概念。类间方差表达式为
$\sigma ^2 = p1(m1-mG)^2+p2(m2-mG)^2$

上式化简为$\sigma ^2 = p1p2(m1-m2)^2$ ----（1）

**求能使得上式最大化的灰度级k就是OTSU阈值，其中：**
$$
    p1 = \sum_{i=0}^k{p_{i}} \\
    m1 = \frac{1}{p1}*\sum_{i=0}^k{ip_{i}} \\
    m2 = \frac{1}{p2}*\sum_{i=k+1}^{L-1}{ip_{i}}
$$

遍历0~255个灰度等级。求出使（1）式最大的k就完成。